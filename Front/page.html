<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/index.css" />
    <title>Finanças</title>
  </head>
  <body>
    <section class="registros">
      <div class="botoes">
        <div class="lista-mes">
          <select id="lista">
            <option value="01">Jan</option>
            <option value="02">Fev</option>
            <option value="03">Mar</option>
            <option value="04">Abr</option>
            <option value="05">Mai</option>
            <option value="06">Jun</option>
            <option value="07">Jul</option>
            <option value="08">Ago</option>
            <option value="09">Set</option>
            <option value="10">Out</option>
            <option value="11">Nov</option>
            <option value="12">Dez</option>
          </select>
        </div>
        <div class="subir-extrato">
          <input type="file" accept=".ofx" id="subir-arquivo" />
          <button id="envia">Enviar</button>
        </div>
      </div>
      <div class="Tabelas">
        <div class="total-entrada">
          <h3>Entrada</h3>
          <table id="t-entrada">
            <thead>
              <tr>
                <th>Data</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="total-saida">
          <h3>Saída</h3>
          <table id="t-saida">
            <thead>
              <tr>
                <th>Data</th>
                <th>Total</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="maiores-gastos">
          <table id="m-gastos">
            <thead>
              <tr>
                <th>Maiores Gastos</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <div class="extrato">
        <div>
          <table id="tabela-extrato">
            <thead>
              <tr>
                <th>Dia</th>
                <th>Onde</th>
                <th>Valor</th>
                <th>Tipo</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
    <section class="grafico"></section>
    <script>
      function fetchDados() {
        fetch("http://127.0.0.1:5000/get_dados") // URL do backend
          .then((response) => response.json())
          .then((data) => {
            const tbody = document
              .getElementById("tabela-extrato")
              .getElementsByTagName("tbody")[0];
            tbody.innerHTML = ""; // Limpa a tabela antes de adicionar os novos dados

            // Preenche a tabela com os dados recebidos
            data.forEach((dado) => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                <td>${dado.data}</td>
                <td>${dado.onde}</td>
                <td>${dado.valor}</td>
                <td>${dado.tipo}</td>
              `;
              tbody.appendChild(tr);
            });
          })
          .catch((error) => console.error("Erro ao buscar dados:", error));
      }

      fetchDados();
    </script>
  </body>
</html>
